title: Autoit3.exe Executable File Creation Matching DarkGate Behavior
id: 1a433e1d-03d2-47a6-8063-ece992cf4e73
status: experimental
description: |
    Detects the usage of curl.exe, KeyScramblerLogon, or other non-standard/suspicious processes used to create Autoit3.exe. 
    This activity has been associated with DarkGate malware, which uses Autoit3.exe to execute shellcode that performs 
    process injection and connects to the DarkGate command-and-control server. Curl, KeyScramblerLogon, and these other 
    processes consitute non-standard and suspicious ways to retrieve the Autoit3 executable.
references:
    - Internal Research
    - https://github.security.telekom.com/2023/08/darkgate-loader.html
    - https://www.kroll.com/en/insights/publications/cyber/microsoft-teams-used-as-initial-access-for-darkgate-malware
    - https://github.com/pr0xylife/DarkGate/tree/main
author: Micah Babinski
date: 2023/10/11
tags:
    - attack.command_and_control
    - attack.execution
    - attack.t1105
    - attack.t1059
logsource:
    category: file_event
    product: windows
detection:
    selection:
        Image|endswith:
            - '\curl.exe'
            - '\KeyScramblerLogon.exe'
            - '\Autoit3.exe'
            - '\wmprph.exe'
            - '\ExtExport.exe'
        TargetFilename|endswith: '\Autoit3.exe'
    condition: selection
falsepositives:
    - Unknown
level: medium